<!DOCTYPE html>
<html>

<head>
  <style>
    body {
      font-family: var(--vscode-font-family);
      padding: 20px;
      background: var(--vscode-editor-background);
      color: var(--vscode-editor-foreground);
    }

    .container {
      max-width: 400px;
      margin: 0 auto;
    }

    #picker {
      margin: 10px 0;
      width: 100%;
      height: 60px;
      border: none;
      border-radius: 4px;
      border-color: #8080804d;
      cursor: pointer;
    }

    .picker-wrapper {
      position: relative;
    }

    .current-color {
      position: absolute;
      left: 0;
      top: 27px;
      width: 100%;
      text-align: center;
      pointer-events: none;
    }

    #color-value {
      margin-left: 6px;
      font-family: 'Consolas';
    }

    .footer {
      margin: 20px 0;
      display: grid;
      grid-template-columns: auto auto;
      column-gap: 20px;
    }

    .button {
      background: var(--vscode-button-background);
      color: var(--vscode-button-foreground);
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
    }

    .button:hover {
      background: var(--vscode-button-hoverBackground);
    }

    .button.secondary {
      background: var(--vscode-button-secondaryBackground);
      color: var(--vscode-button-secondaryForeground);
    }

    .button.secondary:hover {
      background: var(--vscode-button-secondaryHoverBackground);
    }
  </style>
</head>

<body>
  <div class="container">
    <h2>${PickColor.title}</h2>
    <p>${PickColor.html.description}</p>

    <div class="picker-wrapper">
      <input type="color" id="picker" value="#007acc" />
      <div id="current-color" class="current-color" style="color: white;">
        ${PickColor.html.colorValue}<span id="color-value">#007acc</span>
      </div>
    </div>

    <div class="footer">
      <button class="button secondary" onclick="reset()">${PickColor.html.reset}</button>
      <button class="button" onclick="apply()">${PickColor.html.apply}</button>
    </div>
  </div>

  <script>
    const vscode = typeof acquireVsCodeApi === 'function' ? acquireVsCodeApi() : null;
    const picker = document.getElementById('picker');
    const currentColor = document.getElementById('current-color');
    const colorValue = document.getElementById('color-value');

    picker.addEventListener('input', (e) => {
      const color = e.target.value;
      const hex = Number(color.replace('#', '0x'));
      const rgb = {
        r: (hex >> 16) & 255,
        g: (hex >> 8) & 255,
        b: hex & 255
      };
      const brightness = (rgb.r * 299 + rgb.g * 587 + rgb.b * 114) / 1000;
      currentColor.style.color = brightness > 128 ? '#000000' : '#ffffff';
      colorValue.textContent = color.toUpperCase();
    });

    const apply = () => vscode.postMessage({ command: 'apply', color: picker.value });
    const reset = () => vscode.postMessage({ command: 'reset' });
  </script>
</body>

</html>